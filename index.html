<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>Tsubaki | AR</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="./assets/vendor/toastify.min.css"
    />
    <link rel="shortcut icon" href="TemplateData/favicon.ico" />
    <link rel="stylesheet" href="TemplateData/style.css" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="stylesheet" href="./assets/input.css" />
    <link rel="stylesheet" href="./assets/font.css" />
    <link rel="stylesheet" href="./assets/style.css" />
  </head>
  <body class="dark">
    <div id="scene-layout">
      <!-- <div id="layout-size"></div> -->
      <!-- //////////////////////// -->
      <div id="scene-end">
        <div id="back-home" class="flower-img scene-end">
          <img src="./assets/images/flower-2.png" alt="" />
        </div>
        <div class="share-text">
          <img src="./assets/images/share-text.png" alt="" />
        </div>
        <div class="gift">
          <img src="./assets/images/gift.png" alt="" />
        </div>
        <div class="hashtag">
          <p>#tsubakivietnam</p>
          <p>#phuchoihuton</p>
        </div>
        <div style="text-align: center">
          <div class="scene-end-btns">
            <div>
              <div class="btn scene-end-btn">copy hashtag</div>
            </div>
            <div class="btn scene-end-btn share-btn">share</div>
          </div>
        </div>
        <div class="flower-bottom">
          <img src="./assets/images/flower-bottom.png" alt="" />
        </div>
      </div>
      <!-- ///////////////////////// -->
      <div id="scene-first">
        <div class="flower-img">
          <img src="./assets/images/flower-2.png" alt="" />
        </div>
        <div class="tsubaki-img">
          <img src="./assets/images/tsubaki-logo.png" alt="" />
        </div>
        <div class="headline">
          <img src="./assets/images/headline.png" alt="" />
        </div>
        <div class="gift-n-model">
          <img src="./assets/images/model-gift.png" alt="" />
        </div>
        <div style="text-align: center">
          <div id="scan-btn" class="btn">scan chai tsubaki ngay</div>
        </div>
        <div class="privacy-policy">
          <div>
            <label
              for="privacy-policy-checkbox"
              class="privacy-policy-checkbox"
            >
              <input id="privacy-policy-checkbox" type="checkbox" />
              <span class="checkmark"></span>
            </label>
          </div>
          <div class="">
            Tôi đồng ý cho Thương hiệu TSUBAKI/ Công ty FT xử lý các dữ liệu cá
            nhân của tôi (bao gồm hình ảnh, video mà tôi chia sẻ) cho mục đích
            phân tích nội bộ của Thương hiệu/Công ty, tiếp thị, chăm sóc Khách
            hàng và các mục đích hợp pháp khác, với các điều khoản và điều kiện
            tại
            <a
              target="_blank"
              href="https://docs.google.com/document/d/1I5x1TWCJf23jhAj0bIVsz8r8VVlpFw-j/edit"
              >Chính sách Bảo mật quyền riêng tư</a
            >
          </div>
        </div>
      </div>
      <div id="dont-support-ui">
        Trang web này được tối ưu cho thiết bị di động. <br />
        Vui lòng chuyển sang sử dụng thiết bị di động.
      </div>
      <!-- ///////////////////////// -->
    </div>
    <div id="unity-container" class="unity-desktop">
      <canvas id="unity-canvas"></canvas>
    </div>
    <div id="loading-cover" style="display: none">
      <div id="unity-loading-bar">
        <div id="unity-logo"><img src="logo.png" /></div>
        <div id="unity-progress-bar-empty" style="display: none">
          <div id="unity-progress-bar-full"></div>
        </div>
        <div class="spinner"></div>
      </div>
    </div>
    <div id="unity-fullscreen-button" style="display: none"></div>
    <script
      type="text/javascript"
      src="./assets/vendor/toastify-js.js"
    ></script>
    <script src="videoRecorder.js" type="text/javascript"></script>
    <script src="./assets/main.js"></script>
    <script>
      //*****************************************************************************
      function InitVideo() {
        NativeSetCanvasRecorder();
      }
      function PlayMusic() {
        PlayAudio(0);
      }
      function StopMusic() {
        StopAudio(0);
      }
      function StartVideo() {
        mediaStart();
      }
      function EndVideo() {
        mediaStop();
      }

      function UnityOpenNative() {
        //button download was clicked
        console.log("display native end Scene");
        document.getElementById("endSceneDiv").style.display = "block";
      }
      function NativeSendBlobUrl(blob) {
        //video save and send blobUrl
        console.log("............................");
        console.log(blob);
      }
      function UnityLoaded() {
        //Unity is loaded
        console.log("Unity is loaded");
        console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>");
        createMediaRecorder();
        console.log("<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<");
      }

      function UnityShare() {
        //button share was clicked
        console.log("share BUTTON in unity");
        //downloadVideo();
      }
      function UnityDownload() {
        //button download was clicked
        console.log("download BUTTON in unity");
        downloadVideo();
        //downloadVideo();
      }
      //*****************************************************************************
      const hideFullScreenButton = "";
      const buildUrl = "Build";
      const loaderUrl = buildUrl + "/Builds.loader.js";
      const config = {
        dataUrl: buildUrl + "/Builds.data.unityweb",
        frameworkUrl: buildUrl + "/Builds.framework.js.unityweb",
        codeUrl: buildUrl + "/Builds.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "Tsubaki | AR",
        productVersion: "0.1",
      };

      const container = document.querySelector("#unity-container");
      const canvas = document.querySelector("#unity-canvas");
      const loadingCover = document.querySelector("#loading-cover");
      const progressBarEmpty = document.querySelector(
        "#unity-progress-bar-empty"
      );
      const progressBarFull = document.querySelector(
        "#unity-progress-bar-full"
      );
      //const fullscreenButton = document.querySelector("#unity-fullscreen-button");
      const spinner = document.querySelector(".spinner");

      const canFullscreen = (function () {
        for (const key of [
          "exitFullscreen",
          "webkitExitFullscreen",
          "webkitCancelFullScreen",
          "mozCancelFullScreen",
          "msExitFullscreen",
        ]) {
          if (key in document) {
            return true;
          }
        }
        return false;
      })();

      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
        config.devicePixelRatio = 2;
      }
      loadingCover.style.display = "";

      const script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          spinner.style.display = "none";
          progressBarEmpty.style.display = "";
          progressBarFull.style.width = `${100 * progress}%`;
        })
          .then((unityInstance) => {
            loadingCover.style.display = "none";
            /*
          if (canFullscreen) {
            if (!hideFullScreenButton) {
              fullscreenButton.style.display = "";
            }
            fullscreenButton.onclick = () => {
              unityInstance.SetFullscreen(1);
            };
          }
          */
          })
          .catch((message) => {
            alert(message);
          });
      };
      document.body.appendChild(script);
    </script>
    <div
      id="endSceneDiv"
      style="
        display: none;
        background-color: white;
        width: 100vw;
        height: 100vh;
        position: absolute;
        left: 0px;
        top: 0px;
        z-index: 9999;
      "
    >
      <h1>stand in result scene</h1>
      <button onclick="GetBlobUrl()">get blob</button>
      <button onclick="downloadVideo()">download video</button>
    </div>
  </body>
</html>
